<link rel="stylesheet" href="set-password.css">
<% if (keyValid || typeof user == 'object') { %>
<% if (typeof user == 'object') { %>
<h3>Kennwort ändern</h3>
<% } else { %>
<h3>Setze dein Passwort</h3>
<p>
  Hier kannst Du Dein Passwort für den RetroStart-Webserver setzen.  Den
  Zugang brauchst Du, um Deine persönliche Konfiguration herunterzuladen.
</p>
<% } %>
<form id="loginForm" action="/auth/set-password" method="post">
  <input type="hidden" name="key" value="<%= key %>">
  <% if (typeof user == 'object') { %>
  <input type="hidden" name="username" id="username" value="<%= user.username %>">
  <div>
    <label for="password">Altes Password:</label>
    <input type="password" id="oldPassword" name="oldPassword" required>
  </div>
  <% } %>
  <div>
    <label for="password">Neues Password:</label>
    <input type="password" id="password" name="password" required>
  </div>
  <div>
    <label for="confirmPassword">Nochmal:</label>
    <input type="password" id="confirmPassword" name="confirmPassword" required>
  </div>
  <div class="password-rules">
    <p>
      Das Passwort muss mindestens 8 Zeichen lang sein und mindestens einen
      Großbuchstaben, einen Kleinbuchstaben, eine Zahl und ein Sonderzeichen
      enthalten. Dein Benutzername und Trivialitäten ("abc", "123" usw.) dürfen
      nicht enthalten sein. Das neue Passwort darf nicht identisch mit dem
      alten Passwort sein.
    </p>
  </div>
  <button type="submit" id="submitBtn" disabled>Password setzen</button>
  <script src="set-password.js"></script>
</form>
<% } else { %>
<h1>Link nicht gültig</h1>
<p>Der Link zum Zurücksetzen des Passworts ist nicht gültig. Bitte fordere einen neuen Link an.</p>
<% } %>
